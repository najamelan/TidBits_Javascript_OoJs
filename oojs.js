/*
 TidBits OoJs - version: 13.08.14-alpha
 README: https://github.com/najamelan/TidBits_Javascript_OoJs
*/
var TidBits=TidBits||{};
(function(w,n){function G(b,d,f,a,c){this.Static=d;this.IFace=c;this.Class=b[f];this.name=f;this.id=a;this.bases=[];this.overrideAccess={staticLayout:{},instanceLayout:{}};this.layoutInstance=this.instanceLayout=this.staticLayout=null;this.inherited={staticLayout:!1,instanceLayout:!1};this.virtuals={};this.namespace=b}function x(b,d,c){this._this=b;this.classID=d;this.iFace=c;this.state={};this.supers=[];this.flags=0}function v(){return null}function H(b,d,f){function a(){}function g(){}var e=b[d];
Object.defineProperty(a,"Public",{value:y});Object.defineProperty(a,"Protected",{value:z});Object.defineProperty(a,"Private",{value:A});Object.defineProperty(a,"getPrivateInstance",{value:I});Object.defineProperty(a,"ooID",{value:q()});Object.defineProperty(e,"ooID",{value:a.ooID});Object.defineProperty(a,"toString",{value:function(){return"function Static(){ /*"+d+"*/ }"}});Object.defineProperty(e,"toString",{value:function(){return"function "+d+"()"}});l[a.ooID]=new G(b,a,d,a.ooID,g);c[a.ooID]=
new x(a,a.ooID,e);r[d]=a.ooID;f!==n&&(e.prototype=Object.create(b[f].prototype),l[a.ooID].bases=Array(f),r[f]&&c[a.ooID].supers.push(r[f]));Object.defineProperty(e.prototype,"constructor",{configurable:!0,value:e});Object.defineProperty(e.prototype,"Public",{configurable:!0,value:y});Object.defineProperty(e.prototype,"Protected",{configurable:!0,value:z});Object.defineProperty(e.prototype,"Private",{configurable:!0,value:A});Object.defineProperty(e.prototype,"Super",{configurable:!0,value:J});Object.defineProperty(e.prototype,
"Virtual",{configurable:!0,value:K});g.prototype=Object.create(e.prototype);return a}function y(){return s.call(this,arguments,k.PUBLIC)}function z(){s.call(this,arguments,k.PROTECTED)}function A(){s.call(this,arguments,k.PRIVATE)}function I(b){var d;return this!==l[c[this.ooID].classID].Static?null:(d=t(b.ooID,this.ooID))?c[d]._this:null}function L(b){return l[c[b.ooID].classID].name}function K(){s.call(this,arguments,k.VIRTUAL);var b=Array.prototype.slice.apply(arguments);b[b.length]=k.VIRTUAL;
return b}function J(){if(c[this.ooID]&&0!==c[this.ooID].supers.length)throw Error("This object already has a parent. You have to call Super before calling Public or Protected.");B.apply(this,arguments)}function B(){if(l[c[(this.prototype?this.prototype.constructor:this.constructor).ooID].classID].Static!==this){if(this.ooID===n){Object.defineProperty(this,"ooID",{value:q()});var b=new l[this.constructor.ooID].IFace;Object.defineProperty(b,"ooID",{value:this.ooID});c[this.ooID]=new x(this,this.constructor.ooID,
b)}for(var b=l[c[this.ooID].classID],d,f=b.bases.length-1;0<=f;--f){var a=b.bases[f];r[a]&&0===c[this.ooID].supers.length&&(this[a]={},C.prototype=b.namespace[a].prototype,d=new C(b.namespace[a],arguments),c[this.ooID].supers.push(d.ooID),M.call(c[d.ooID]._this),this[a]=d)}}}function M(){D.call(this,{instRec:c[this.ooID],layout:l[c[this.ooID].classID].instanceLayout,iFace:c[this.ooID].iFace},!0)}function C(b,d){return b.apply(this,d)}function s(b,d){B.apply(this);var f=l[c[this.ooID].classID].Static===
this?"staticLayout":"instanceLayout",a={instRec:c[this.ooID],classID:c[this.ooID].classID,supers:c[this.ooID].supers,iFace:c[this.ooID].iFace,classMeta:l[c[this.ooID].classID],virtuals:l[c[this.ooID].classID].virtuals,layout:l[c[this.ooID].classID][f],layoutTypeFlag:l[c[this.ooID].classID].Static===this?k.INHERITED_STATIC:k.INHERITED_INSTANCE,layoutType:f,accessLvl:d};if(!(a.instRec.flags&k.STORED)){c[this.ooID].flags|=k.STORED;var g=null===a.layout;g&&(a.layout=a.classMeta[a.layoutType]={});for(var e in this)this.hasOwnProperty(e)&&
(g&&E(a.layout,e,null,k.PRIVATE,a.classID,!0),a.instRec.state[e]=this[e],delete this[e])}if(!a.classMeta.inherited[a.layoutType])for(a.classMeta.inherited[a.layoutType]=!0,g=a.supers.length-1;0<=g;--g){e=l[c[a.supers[g]].classID][a.layoutType];var u=l[c[a.supers[g]].classID].virtuals,h;for(h in e)if(e.hasOwnProperty(h)&&!(e[h].flags&k.PRIVATE))if(a.layout[h]===n)a.layout[h]=e[h],a.layout[h].flags=e[h].flags&~k.VIRTUAL;else if(a.layout[h].ownerClass!==a.classID)throw Error("two baseclasses both provide member: "+
h);for(var m in u)if(u.hasOwnProperty(m)&&(e[m]===n||e[m].flags&k.VIRTUAL)){a.virtuals[m]=[];for(var p in u[m])a.virtuals[m][a.virtuals[m].length]=u[m][p]}}if(null===a.classMeta.layoutInstance||this.ooID===a.classMeta.layoutInstance)for("instanceLayout"===f&&(a.classMeta.layoutInstance=this.ooID),m=b.length-1;0<=m;--m)if(h=b[m],Array.isArray(h)&&h[h.length-1]===k.VIRTUAL)for(p=h.length-2;0<=p;--p)F.call(this,a,h[p]);else F.call(this,a,h);if("instanceLayout"===f)for(m=b.length-1;0<=m;--m)if(h=b[m],
"function"===typeof h&&(h=/\W*function\W+([\w\$]+)\(/.exec(h.toString())[1],a.virtuals[h]!==n))for(p=a.virtuals[h].length-1;0<=p;--p)a.virtuals[h][p].ownerClass!==a.classID&&N.call(this,a,h,a.virtuals[h][p].ownerClass);k.VIRTUAL!==d&&D.call(this,a);if(d===k.PUBLIC&&"instanceLayout"===f)return c[this.ooID].iFace}function F(b,d){var c,a,g="";if("function"===typeof d)a=/\W*function\W+([\w\$]+)\(/.exec(d.toString())[1],c=d;else if("string"===typeof d){var e=d.split(".");a=e.pop();g=e.pop();if(e.length)throw Error("More than one dot found in: "+
d);g?(e=b.classMeta.overrideAccess[b.layoutType],e[g]=e[g]||[],e[g][a]=b.accessLvl):g=""}b.layout[a]!==n&&(b.instRec.iFace[a]!==n&&!(b.accessLvl&k.PUBLIC)&&b.layout[a].flags&k.PUBLIC)&&delete b.instRec.iFace[a];if(b.layout[a]!==n&&c&&b.layout[a].ownerClass!==b.classID||b.layout[a]===n&&c)E(b.layout,a,c,b.accessLvl,b.classID,!1);else if(b.layout[a]!==n&&(""===g&&b.layout[a].ownerClass===b.classID||g===l[b.layout[a].ownerClass].name))b.layout[a].flags=b.accessLvl|b.layout[a].flags&k.VIRTUAL;else throw Error("Couldn't find definition of member: "+
(g?g+".":"")+a+" in class: "+b.classMeta.name);b.accessLvl&k.VIRTUAL&&(b.virtuals[a]=b.virtuals[a]||[],b.virtuals[a].push(b.layout[a]))}function N(b,d,f){f=t(this.ooID,f);delete c[f]._this[d];Object.defineProperty(c[f]._this,d,{enumerable:!0,configurable:!0,get:function(a,b){return function(){return a.bind(b)}}(b.layout[d].reference,this)})}function D(b,d){var f=Object.defineProperty,a;for(a in b.layout)if(b.layout.hasOwnProperty(a)){var g=b.layout[a],e=g.reference,l;l=!0===d?g.flags&k.PROTECTED?
[b.iFace]:[]:g.flags&k.PUBLIC?[this,b.iFace]:[this];for(var h=l.length-1;0<=h;--h){var m=t(this.ooID,g.ownerClass);e?f(l[h],a,{enumerable:!0,configurable:!0,get:function(a,b){return function(){return a.bind(b)}}(e,c[m]._this)}):f(l[h],a,{enumerable:!0,configurable:!0,get:function(a,b){return function(){return c[b].state[a]}}(a,m),set:function(a,b){return function(d){c[b].state[a]=d}}(a,m)})}}}function t(b,d){if(c[b].classID===d)return b;for(var f=null,a,g=c[b].supers.length-1;a=c[b].supers[g];--g)if(a.classID===
d){f=a;break}else if(null!==(f=t(a,d)))break;return f}function E(b,c,f,a,g,e){if(b[c]!==n&&e)throw Error("Property '"+c+"' is already defined");b[c]={flags:a,reference:f,ownerClass:g}}function q(){q.counter=q.counter||0;return++q.counter}if(!w.OoJs){w.OoJs=v;var l={},c={},r={},k={PRIVATE:1,PROTECTED:2,PUBLIC:4,VIRTUAL:8,INHERITED_INSTANCE:16,INHERITED_STATIC:32,STORED:64};v.setupClass=H;v.typeOf=L}})(TidBits);"undefined"!==typeof module&&(module.exports.OoJs=TidBits.OoJs);
